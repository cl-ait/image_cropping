# GPT-4 Vision Image Cropper

このツールは、OpenAI の GPT-4 Vision モデルを活用して、指定された画像内の特定領域を自動でクロップ（切り抜き）する Python プログラムです。指示文（プロンプト）を入力するだけで、対象物の座標を取得し、クロップ画像を生成・表示します。

---

## 仕様

- GPT-4o（GPT-4 Vision）を使用して画像解析を実施
- 指定した自然言語の説明に基づいてクロップ領域を自動算出
- PIL と matplotlib による画像の視覚的表示
- クロップ結果と元画像を並べて確認可能
- 日本語説明文にも対応（matplotlib用フォント設定済み）

---

## 必要なライブラリ

以下のライブラリが必要：

```bash
pip install openai Pillow matplotlib
```

## 使い方
```bash
python crop_with_gpt.py --image path/to/image.jpg --instruction "右上のリンゴ" --output cropped.jpg --api_key YOUR_API_KEY
```

| 引数            | 説明                                          |
|-----------------|-----------------------------------------------|
| `--image`       | クロップ対象の画像パス（必須）                      |
| `--instruction` | クロップ対象の自然言語による説明（必須）               |
| `--output`      | クロップ画像の出力先パス（任意） |
| `--api_key`     | OpenAI APIキー                |
| `--debug`       | APIレスポンスや座標などの詳細ログを出力               |



## 出力例
入力画像に赤い枠でクロップ領域を表示

元画像（左）と切り抜き画像（右）を並べて視覚的に表示

クロップ領域の座標と GPT による簡易説明も表示

## 日本語フォント対応について
matplotlibで日本語を正しく表示するために、OSごとに最適なフォントを自動選択する仕組みが含まれています。

## 注意点
GPTから返されるJSONの形式が崩れている場合は、プログラムが自動修正を試みますが、完全にはできない場合もあります。

画像サイズや指示内容によっては、期待する領域を正確にクロップできないこともあります。

